<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>ê²½ì¡°ì‚¬ ë©”ì‹œì§€ ìƒì„±ê¸°</title>
  <meta name="description" content="ê²°í˜¼, ì¥ë¡€, ëŒì”ì¹˜, ë¶€ëª¨ë‹˜ì”ì¹˜, ë°˜ë ¤ë™ë¬¼ ì¥ë¡€ ë©”ì‹œì§€ ìƒì„±/ê³µìœ " />
  <style>
    :root{
      --bg:#0b0c10; --card:#121319; --muted:#7d8590; --text:#e6edf3; --acc:#6dd3fb; --acc2:#b7f399;
      --danger:#ff6b6b; --ok:#34d399; --brand:#6366f1; --shadow:0 10px 30px rgba(0,0,0,.25);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:linear-gradient(180deg,#0b0c10, #0e1117 40%, #0b0c10);
         color:var(--text);font-family: ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans KR",Apple SD Gothic Neo,Helvetica,Arial,sans-serif;
         -webkit-font-smoothing:antialiased;}
    .wrap{max-width:680px;margin:0 auto;padding:24px;}
    .card{background:var(--card);border:1px solid #1f232b;border-radius:20px;padding:20px;box-shadow:var(--shadow)}
    h1{font-size:24px;margin:0 0 10px;letter-spacing:-.3px}
    p.lead{margin:0 0 16px;color:var(--muted);font-size:14px}
    .grid{display:grid;gap:14px}
    .row{display:flex;gap:8px;flex-wrap:wrap}
    label{display:block;font-weight:600;margin-bottom:8px}
    .radio-group{display:grid;gap:10px}
    .radio{display:flex;align-items:center;gap:10px;background:#0e1320;border:1px solid #202635;padding:12px;border-radius:14px}
    .radio input{transform:scale(1.2)}
    .note{font-size:12px;color:var(--muted)}
    input[type="text"], .ghost{
      width:100%;padding:12px 14px;border-radius:12px;border:1px solid #263042;background:#0b1222;color:var(--text);outline:none;
    }
    input[type="text"]:focus{border-color:var(--acc)}
    button{appearance:none;border:0;border-radius:14px;padding:14px 16px;font-weight:700;cursor:pointer}
    .btn{background:linear-gradient(135deg,var(--brand),#22d3ee);color:#fff;box-shadow:0 8px 20px rgba(99,102,241,.3)}
    .btn:active{transform:translateY(1px)}
    .btn-ghost{background:transparent;color:var(--text);border:1px solid #253046}
    .hidden{display:none}

    /* Viewer */
    .viewer h2{font-size:20px;margin:0 0 12px}
    .meta{display:flex;gap:8px;flex-wrap:wrap;color:var(--muted);font-size:12px;margin-bottom:10px}
    .paper{background:#0c111b;border:1px dashed #24314a;border-radius:16px;padding:18px}
    .heroimg{width:100%;max-height:320px;object-fit:cover;border-radius:12px;border:1px solid #24314a;display:block;margin:0 auto 10px;}
    .toolbar{display:flex;gap:8px;flex-wrap:wrap;margin-top:14px}
    .badge{display:inline-flex;align-items:center;gap:8px;padding:10px;border-radius:14px;border:1px solid #24314a;background:#0b1222}
    .ico{display:inline-grid;place-items:center;width:28px;height:28px;border-radius:9px;background:#111a2c}
    .ico svg{width:18px;height:18px}
    @media (prefers-color-scheme: light){
      :root{--bg:#f6f8fa;--card:#ffffff;--text:#0d1117;--muted:#57606a}
      body{background:linear-gradient(180deg,#f6f8fa,#fff)}
      .radio{background:#f8fafc;border-color:#e5e7eb}
      input[type="text"], .ghost{background:#fff;border-color:#e5e7eb}
      .paper{background:#fafcff;border-color:#e5e7eb}
      .btn-ghost{border-color:#e5e7eb}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <section id="screen-form" class="card">
      <div class="row" style="justify-content:space-between;align-items:center">
        <h1>ê²½ì¡°ì‚¬ ë©”ì‹œì§€ ìƒì„±ê¸°</h1>
        <div class="badge"><span class="ico" aria-hidden="true">ğŸ’Œ</span>ê°„í¸ ìƒì„± Â· ê³µìœ  ë§í¬</div>
      </div>
      <p class="lead">í•„ìš”í•œ ê²½ì¡°ì‚¬ ë¬¸êµ¬ë¥¼ ì„ íƒí•˜ê³  ì •ë³´ë¥¼ ì…ë ¥í•˜ì„¸ìš”. ìƒì„± í›„ ë§í¬ë¡œ ê³µìœ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
      <div class="grid">
        <div>
          <label>ì§ˆë¬¸1. ê²½ì¡°ì‚¬ ì¢…ë¥˜ë¥¼ ì„ íƒí•˜ì„¸ìš” <span class="note">(í•„ìˆ˜)</span></label>
          <div class="radio-group" role="radiogroup" aria-label="ê²½ì¡°ì‚¬ ì¢…ë¥˜">
            <label class="radio"><input type="radio" name="type" value="wedding"> ê²°í˜¼</label>
            <label class="radio"><input type="radio" name="type" value="funeral"> ê°€ì¡±ì¥ë¡€ì‹</label>
            <label class="radio"><input type="radio" name="type" value="firstbirthday"> ëŒì”ì¹˜</label>
            <label class="radio"><input type="radio" name="type" value="parents"> ë¶€ëª¨ë‹˜ì”ì¹˜</label>
            <label class="radio"><input type="radio" name="type" value="petfuneral"> ì• ê²¬Â·ì• ë¬˜ ì¥ë¡€ì‹</label>
          </div>
        </div>
        <div id="row-aaa" class="hidden">
          <label>ì§ˆë¬¸2. ëŒì”ì¹˜ì¸ ê²½ìš°, ì•„ì´ ì´ë¦„ <span class="note">(ì„ íƒ)</span></label>
          <input type="text" id="input-aaa" maxlength="20" placeholder="ì•„ì´ ì´ë¦„ (ì˜ˆ: ì§€ìš°)" />
          <p class="note">ì…ë ¥ ì‹œ ë©”ì‹œì§€ ë‚´ AAAê°€ ì•„ì´ ì´ë¦„ìœ¼ë¡œ ë°”ë€ë‹ˆë‹¤.</p>
        </div>
        <div>
          <label>ì§ˆë¬¸3. ë°œì†¡í•˜ëŠ” ë¶„ì˜ ì´ë¦„ <span class="note">(í•„ìˆ˜)</span></label>
          <input type="text" id="input-bbb" maxlength="20" placeholder="ë³´ë‚´ëŠ” ì´ (ì˜ˆ: ê¹€OO)" required />
        </div>
        <div class="row" style="justify-content:flex-end;margin-top:4px">
          <button id="btn-generate" class="btn">ìƒì„±ëœ ê²½ì¡°ì‚¬ ë¬¸êµ¬ HTML ë³´ê¸°</button>
        </div>
      </div>
    </section>

    <section id="screen-view" class="card hidden viewer">
      <div class="row" style="justify-content:space-between;align-items:center">
        <h2 id="view-title">ë©”ì‹œì§€ ë³´ê¸°</h2>
        <div id="badge-type" class="badge"><span class="ico" id="type-emoji" aria-hidden="true">âœ¨</span><span id="type-label">ìœ í˜•</span></div>
      </div>
      <div class="meta" id="meta"></div>
      <div class="paper">
        <div id="msg-image" style="text-align:center;margin-bottom:10px;font-size:28px"></div>
        <div id="message" class="msg"></div>
      </div>
      <div class="toolbar">
        <button id="btn-copy" class="btn">ë§í¬ ë³µì‚¬</button>
        <button id="btn-share" class="btn-ghost">ê³µìœ í•˜ê¸°</button>
        <button id="btn-home" class="btn-ghost">ì²˜ìŒìœ¼ë¡œ</button>
      </div>
    </section>
  </div>

  <script>
    const $ = (s)=>document.querySelector(s);
    const byId = (id)=>document.getElementById(id);

    const typeMeta = {
      wedding: {label:'ê²°í˜¼', emoji:'ğŸ’', image:'./img01.png'},
      funeral: {label:'ê°€ì¡±ì¥ë¡€ì‹', emoji:'ğŸ•Šï¸', image:'./img02.png'},
      firstbirthday: {label:'ëŒì”ì¹˜', emoji:'ğŸ‚', image:'./img03.png'},
      parents: {label:'ë¶€ëª¨ë‹˜ì”ì¹˜', emoji:'ğŸŒ·', image:'./img04.png'},
      petfuneral: {label:'ì• ê²¬Â·ì• ë¬˜ ì¥ë¡€ì‹', emoji:'ğŸ¾', image:'./img05.png'}
    };

    function todayString(){
      const now = new Date();
      return `${now.getFullYear()}ë…„ ${String(now.getMonth()+1).padStart(2,'0')}ì›” ${String(now.getDate()).padStart(2,'0')}ì¼`;
    }

    function randId(len=12){
      let s='';
      while(s.length<len){ s+=Math.random().toString(36).slice(2);}
      return s.slice(0,len);
    }

    function encodePayload(obj){
      const json = JSON.stringify(obj);
      const b64 = btoa(unescape(encodeURIComponent(json)));
      return b64.replaceAll('+','-').replaceAll('/','_').replace(/=+$/,'');
    }
    function decodePayload(str){
      const b64 = str.replaceAll('-','+').replaceAll('_','/');
      const pad = '='.repeat((4-(b64.length%4))%4);
      return JSON.parse(decodeURIComponent(escape(atob(b64+pad))));
    }

    function sanitize(text){return String(text||'').replace(/[&<>\"']/g,s=>({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"}[s]));}

    const templates = {
      wedding:`ì˜¤ë˜ì „ë¶€í„° ë‘ ë¶„ì˜ ì†Œì¤‘í•œ ì¸ì—°ì„ ì§€ì¼œë³´ë©° ì˜¤ëŠ˜ì„ ì†ê¼½ì•„ ê¸°ë‹¤ë ¸ìŠµë‹ˆë‹¤. ì§„ì‹¬ìœ¼ë¡œ ì¶•í•˜ë“œë¦½ë‹ˆë‹¤.
{ë°œì†¡í•œ ë‚ ì§œ}
BBB ë“œë¦¼`,
      funeral:`ê°€ìŠ´ ì•„í”ˆ ì†Œì‹ì— ìŠ¬í””ì„ ê¸ˆí•  ê¸¸ì´ ì—†ìŠµë‹ˆë‹¤.
{ë°œì†¡í•œ ë‚ ì§œ}
BBB ë“œë¦¼`,
      firstbirthday:`ì‚¬ë‘ìŠ¤ëŸ¬ìš´ AAAì˜ ì²« ë²ˆì§¸ ìƒì¼ì„ ì§„ì‹¬ìœ¼ë¡œ ì¶•í•˜í•©ë‹ˆë‹¤.
{ë°œì†¡í•œ ë‚ ì§œ}
BBB ë“œë¦¼`,
      parents:`ì‚¬ë‘í•˜ëŠ” ë¶€ëª¨ë‹˜ê»˜ì„œ ë§ìœ¼ì‹  ì”ì¹˜ë¥¼ ì§„ì‹¬ìœ¼ë¡œ ì¶•í•˜ë“œë¦½ë‹ˆë‹¤.
{ë°œì†¡í•œ ë‚ ì§œ}
BBB ë“œë¦¼`,
      petfuneral:`ì‚¬ë‘í•˜ëŠ” ê°€ì¡±ì„ ë– ë‚˜ë³´ë‚¸ ì¹œêµ¬ì—ê²Œ ê¹Šì€ ìœ„ë¡œì˜ ë§ˆìŒì„ ì „í•©ë‹ˆë‹¤.
{ë°œì†¡í•œ ë‚ ì§œ}
BBB ë“œë¦¼`
    };

    const rowAAA = byId('row-aaa');
    const inputAAA = byId('input-aaa');
    const inputBBB = byId('input-bbb');

    document.querySelectorAll('input[name="type"]').forEach(r=>{
      r.addEventListener('change',()=>{rowAAA.classList.toggle('hidden',r.value!=='firstbirthday'||!r.checked);});
    });

    byId('btn-generate').addEventListener('click',(e)=>{
      e.preventDefault();
      const type=(document.querySelector('input[name="type"]:checked')||{}).value;
      if(!type){alert('ê²½ì¡°ì‚¬ ì¢…ë¥˜ë¥¼ ì„ íƒí•˜ì„¸ìš”.'); return;}
      const bbbRaw = inputBBB.value.trim();
      if(!bbbRaw){alert('ë°œì†¡ì ì´ë¦„(BBB)ì„ ì…ë ¥í•˜ì„¸ìš”.'); return;}
      const aaaRaw = type==='firstbirthday'? inputAAA.value.trim(): '';
      const date = todayString();
      const payload = {t:type,a:aaaRaw,b:bbbRaw,d:date};
      const id = randId(12);
      const p = encodePayload(payload);
      const url = `${location.origin}${location.pathname}#v=1&r=${id}&p=${p}`;
      location.href = url;
    });

    function show(name){
      byId('screen-form').classList.toggle('hidden',name!=='form');
      byId('screen-view').classList.toggle('hidden',name!=='view');
    }

    function applyTemplate({t,a,b,d}){
      const meta = typeMeta[t] || {label:'ë©”ì‹œì§€',emoji:'âœ¨',image:'âœ¨'};
      byId('view-title').textContent = `${meta.label} ë©”ì‹œì§€`;
      byId('type-label').textContent = meta.label;
      byId('type-emoji').textContent = meta.emoji;
      const imgWrap = byId('msg-image'); imgWrap.innerHTML='';
      if(meta.image){
        const img = document.createElement('img');
        img.src = /^(https?:)?\//.test(meta.image)? meta.image : `./${meta.image}`;
        img.alt = `${meta.label} ì´ë¯¸ì§€`; img.className='heroimg'; img.loading='lazy';
        img.decoding='async'; img.referrerPolicy='no-referrer'; imgWrap.appendChild(img);
      }
      let text = templates[t]||'';
      text = text.replaceAll('AAA',sanitize(a||'AAA')).replaceAll('BBB',sanitize(b)).replaceAll('{ë°œì†¡í•œ ë‚ ì§œ}',sanitize(d));
      byId('message').textContent = text;
      byId('meta').textContent = `${d} Â· ìƒì„±ëœ ë§í¬ëŠ” ë©”ì‹œì§€ ë·°ì–´ ì „ìš©ì…ë‹ˆë‹¤.`;
    }

    function parseHash(){
      const h=location.hash||''; if(!h.startsWith('#')) return null;
      const params=new URLSearchParams(h.slice(1)); if(params.get('v')!=='1') return null;
      const p=params.get('p'); if(!p) return null;
      try{return decodePayload(p);}catch{return null;}
    }

    function init(){
      const data=parseHash();
      if(data){show('view'); applyTemplate(data);} else {show('form');}
    }

    byId('btn-copy').addEventListener('click', async()=>{
      try{ await navigator.clipboard.writeText(location.href); alert('ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.'); }
      catch{ prompt('ë³µì‚¬í•  ë§í¬ì…ë‹ˆë‹¤. ìˆ˜ë™ ë³µì‚¬í•´ì£¼ì„¸ìš”:',location.href);}
    });

    byId('btn-share').addEventListener('click', async()=>{
      if(navigator.share){try{await navigator.share({title:document.title,text:byId('view-title').textContent,url:location.href});}catch{}}
      else{alert('ì´ ë¸Œë¼ìš°ì €ëŠ” ê³µìœ  ê¸°ëŠ¥ì„ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë§í¬ ë³µì‚¬ë¥¼ ì´ìš©í•´ì£¼ì„¸ìš”.');}
    });

    byId('btn-home').addEventListener('click',()=>{
      history.pushState({},'',location.pathname); show('form');
      document.querySelectorAll('input[name="type"]').forEach(r=>r.checked=false);
      rowAAA.classList.add('hidden'); inputAAA.value=''; inputBBB.value=''; window.scrollTo({top:0,behavior:'smooth'});
    });

    window.addEventListener('hashchange',init);
    init();
  </script>
</body>
</html>
